# Test against the latest version of this Node.js version
environment:
  nodejs_version: "10"

branches:
  only:
    - master
    - '/v[0-9]+(\.[0-9]+)*/'

# Install scripts. (runs after repo cloning)
install:
  # Get the latest stable version of Node.js or io.js
  - ps: Install-Product node $env:nodejs_version
  # install modules
  # - npm install
  - yarn install --frozen-lockfile

build_script:
  - yarn run build
  - npm version patch

test_script:
  - yarn test

cache:
  - node_modules
  - '%LOCALAPPDATA%/Yarn'

deploy:
  - ps: '"//registry.npmjs.org/:_authToken=$env:npm_auth_token`n" | out-file "$env:userprofile\.npmrc" -Encoding ASCII'

# Don't actually build.
build: off